1. Reduce memory usage.
2. Fixed: a bug in the metadata updating.
3. Fixed: a bug in the preview rendering.
